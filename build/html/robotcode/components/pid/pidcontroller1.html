

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using a PID Controller &mdash; Evans Chen&#39;s Software Guide 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="Evans Chen&#39;s Software Guide 1.0 documentation" href="../../../index.html"/>
        <link rel="up" title="PID Components" href="pid.html"/>
        <link rel="next" title="Tuning a PID Controller" href="pidcontroller2.html"/>
        <link rel="prev" title="PID Components" href="pid.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Evans Chen's Software Guide
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installation/installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../robotcode.html">Robot Code</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../structure/structure.html">Structure</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../components.html">Components</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../sensors/sensors.html">Sensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../actuators/actuators.html">Actuators</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="pid.html">PID Components</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Using a PID Controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="pidcontroller2.html">Tuning a PID Controller</a></li>
<li class="toctree-l4"><a class="reference internal" href="pidsource.html">PID Sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="pidoutput.html">PID Outputs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tasks/tasks.html">Common Tasks</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Evans Chen's Software Guide</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../robotcode.html">Robot Code</a> &raquo;</li>
        
          <li><a href="../components.html">Components</a> &raquo;</li>
        
          <li><a href="pid.html">PID Components</a> &raquo;</li>
        
      <li>Using a PID Controller</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/robotcode/components/pid/pidcontroller1.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-a-pid-controller">
<h1>Using a PID Controller<a class="headerlink" href="#using-a-pid-controller" title="Permalink to this headline">Â¶</a></h1>
<p>This section of the guide assumes you only want to use a PID someone else already created. If you want to create and tune a PID, see the <a class="reference external" href="pidcontroller2.html">Tuning PIDs</a> section.</p>
<p>A PID Controller is a way to get a sensor reading to a certain value by outputting to an actuator.</p>
<p>For example, a PID Controller would be used to get an encoder to turn 10 rotations by running a motor.</p>
<p>In this case, the PIDSource would be the encoder, and the setpoint would be 10 rotations. Then, the PIDOutput would be a speedcontroller connected to the motor.</p>
<a class="reference internal image-reference" href="../../../_images/pidc.png"><img alt="../../../_images/pidc.png" src="../../../_images/pidc.png" style="width: 50%;" /></a>
<p>Although the internals of PIDs may be complicated, a well tuned PID controller will simply do as instructed. If the setpoint is set to 10 rotations, for example, the motor will try to do exactly 10 rotations. A well tuned PID corrects if it overshoots, and tries to get to the setpoint in a smooth way.</p>
<p>Creating a PID:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">PIDController</span> <span class="n">DRIVE_CONTROL</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PIDController</span><span class="o">(</span><span class="mf">0.0015</span><span class="o">,</span> <span class="mf">0.001</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">DRIVE_ENCODER</span><span class="o">,</span> <span class="n">DRIVE_MOTORS</span><span class="o">);</span>
</pre></div>
</div>
<p>Here, a PID Controller that takes input from the Drive Encoder and outputs to the Drive Motors is given the tuned PID values P = 0.0015, I = 0.001, and D = 0.</p>
<p>Then, to make the robot attempt to go forward 10 feet:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">DRIVE_ENCODER</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
<span class="n">DRIVE_CONTROL</span><span class="o">.</span><span class="na">reset</span><span class="o">();</span>
<span class="n">DRIVE_CONTROL</span><span class="o">.</span><span class="na">setSetpoint</span><span class="o">(</span><span class="mf">10.0</span> <span class="o">*</span> <span class="n">TICKS_PER_FOOT</span><span class="o">);</span>
<span class="n">DRIVE_CONTROL</span><span class="o">.</span><span class="na">enable</span><span class="o">();</span>
</pre></div>
</div>
<p>The above code could be placed in the initialize() block of a command.</p>
<p>Then, since a PID automatically outputs to the motor, the execute() block should often be empty.</p>
<p>To check if the robot is at its goal, check the error on the controller.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">boolean</span> <span class="nf">isFinished</span><span class="o">()</span>
<span class="o">{</span>
    <span class="kt">double</span> <span class="n">error</span> <span class="o">=</span> <span class="n">Drive</span><span class="o">.</span><span class="na">DRIVE_CONTROL</span><span class="o">.</span><span class="na">getError</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">Math</span><span class="o">.</span><span class="na">abs</span><span class="o">(</span><span class="n">error</span><span class="o">)</span> <span class="o">&lt;=</span> <span class="n">MAX_ERROR</span><span class="o">)</span>
    <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="kc">false</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Then, to disable the PID Controller, in end():</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="c1">// disable our PIDControllers and then stop all motors</span>
<span class="n">Drive</span><span class="o">.</span><span class="na">DRIVE_CONTROL</span><span class="o">.</span><span class="na">disable</span><span class="o">();</span>
<span class="n">Drive</span><span class="o">.</span><span class="na">setAllMotors</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</pre></div>
</div>
<p>Note how the drive encoder was reset, since we want to go forward 10 feet. If it is not reset, then if the encoder was, for example, already at 5 feet, then the robot would only go 5 feet forwards.</p>
<p>However, note that you do not always want to reset the encoder before setting the setpoint. If using an elevator with known height setpoints, it would be wise simply to use those setpoints and never reset the encoder.</p>
<p>Tuning PID values is covered in the <a class="reference external" href="pidcontroller2.html">Tuning PIDs</a> section.</p>
<div class="toctree-wrapper compound">
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pidcontroller2.html" class="btn btn-neutral float-right" title="Tuning a PID Controller" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pid.html" class="btn btn-neutral" title="PID Components" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright .

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>